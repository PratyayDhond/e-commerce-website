{"ast":null,"code":"import Header from '../../components/Header/Header.vue';\nimport Filter from '../../components/Filter/Filter.vue';\nimport LatestBooks from '../../components/HomePage/LatestBooks.vue';\nimport ResultBook from '../../components/Search/ResultBook.vue';\nimport BookCoverCat from '../../components/HomePage/BookCoverCat.vue';\nimport Sidebar from '../../components/User/OrderHistoryView/Sidebar.vue';\nimport OrderHistory from '../../components/User/OrderHistoryView/OrderHistory.vue';\nimport firebase from 'firebase/compat/app';\nexport default {\n  data() {\n    return {\n      orderedHistory: [{\n        orderID: '46FA4F65A4F6A',\n        bookName: \"Gitanjali\",\n        bookPrice: \"1300\",\n        bookImageURL: \"https://picsum.photos/200/300\",\n        orderDate: \"2 April 2022\",\n        shipTo: \"Ajay sharma\",\n        bookYear: \"1910\",\n        bookGenre: \"Poem\",\n        bookAuthor: \"Rabindranath Tagore\",\n        bookDelivered: \"8 April 2022\"\n      }, {\n        orderID: '46FA4F65A4F6A',\n        bookName: \"A Thousand Splendid Suns\",\n        bookPrice: \"1300\",\n        bookImageURL: \"https://picsum.photos/200/300\",\n        orderDate: \"2 April 2022\",\n        shipTo: \"Ajay sharma\",\n        bookYear: \"1910\",\n        bookGenre: \"Poem\",\n        bookAuthor: \"Rabindranath Tagore\",\n        bookDelivered: \"8 April 2022\"\n      }],\n      id: this.$route.query.id,\n      orders: []\n    };\n  },\n\n  async created() {\n    this.orderedHistory = [];\n    var name;\n    await firebase.firestore().collection('Users').doc(this.id).get().then(snapshot => {\n      this.orders = snapshot.data().orders;\n      name = snapshot.data().name;\n    });\n    console.log(this.orders);\n    this.orders.forEach(async order => {\n      var orderID = order;\n      await firebase.firestore().collection('Orders').doc(order).get().then(r => {\n        if (r.data().orderCompleted === true) {\n          var orderDate = this.calcTime(r.data().orderDate);\n          var bookDelivered = this.calcTime(r.data().bookDelivered);\n          r.data().books.forEach(async book => {\n            var obj = new Object();\n            await firebase.firestore().collection('books').doc(book).get().then(r => {\n              console.log(r.data());\n              obj.bookName = r.data().name;\n              obj.bookID = book;\n              obj.bookPrice = r.data().price;\n              obj.bookYear = r.data().publicationYear;\n              obj.bookGenre = r.data().genre;\n              obj.bookAuthor = r.data().author;\n              obj.bookImageURL = r.data().url;\n            }).finally(() => {\n              obj.shipTo = name;\n              obj.orderID = orderID;\n              obj.orderDate = orderDate;\n              obj.bookDelivered = bookDelivered;\n              this.orderedHistory.push(obj);\n              console.log(this.orderedHistory);\n              obj = new Object();\n            });\n          });\n        }\n      });\n    }); // const ordersRef = collection(db, 'Orders');\n    // const q = query(ordersRef, where(\"orderCompleted\",\"==\", true))\n    // const querySnapshot = await getDocs(q);\n    // querySnapshot.forEach(doc => {\n    // this.orders = doc.data();\n    // })\n    // console.log(this.orders)\n  },\n\n  methods: {\n    calcTime(timestamp) {\n      timestamp = timestamp ?? 0;\n      var seconds = timestamp.seconds;\n      var time = new Date(seconds * 1000);\n      var date = time.getDate() < 10 ? \"0\" + time.getDate() : time.getDate();\n      var year = time.getFullYear();\n      var month = time.getMonth() < 10 ? \"0\" + time.getMonth() : time.getMonth();\n      return date + \"-\" + month + '-' + year;\n    }\n\n  },\n  components: {\n    Header,\n    Filter,\n    LatestBooks,\n    ResultBook,\n    BookCoverCat,\n    Sidebar,\n    OrderHistory\n  }\n};","map":{"version":3,"mappings":"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","names":["Header","Filter","LatestBooks","ResultBook","BookCoverCat","Sidebar","OrderHistory","firebase","data","orderedHistory","orderID","bookName","bookPrice","bookImageURL","orderDate","shipTo","bookYear","bookGenre","bookAuthor","bookDelivered","id","$route","query","orders","created","name","firestore","collection","doc","get","then","snapshot","console","log","forEach","order","r","orderCompleted","calcTime","books","book","obj","Object","bookID","price","publicationYear","genre","author","url","finally","push","methods","timestamp","seconds","time","Date","date","getDate","year","getFullYear","month","getMonth","components"],"sourceRoot":"","sources":["W:\\Coding\\finalProject\\e-commerce-website\\src\\views\\OrderHistory\\OrderHistory.vue"],"sourcesContent":["<script>\r\nimport Header from '../../components/Header/Header.vue';\r\nimport Filter from '../../components/Filter/Filter.vue';\r\nimport LatestBooks from '../../components/HomePage/LatestBooks.vue';\r\nimport ResultBook from '../../components/Search/ResultBook.vue';\r\nimport BookCoverCat from '../../components/HomePage/BookCoverCat.vue';\r\nimport Sidebar from '../../components/User/OrderHistoryView/Sidebar.vue';\r\nimport OrderHistory from '../../components/User/OrderHistoryView/OrderHistory.vue';\r\nimport firebase from 'firebase/compat/app';\r\n\r\nexport default{\r\n    data(){\r\n        return{\r\n            orderedHistory:[\r\n                {   \r\n                    orderID:'46FA4F65A4F6A',\r\n                    bookName:\"Gitanjali\",\r\n                    bookPrice:\"1300\",\r\n                    bookImageURL:\"https://picsum.photos/200/300\",\r\n                    orderDate:\"2 April 2022\",\r\n                    shipTo: \"Ajay sharma\",\r\n                    bookYear: \"1910\",\r\n                    bookGenre: \"Poem\",\r\n                    bookAuthor:\"Rabindranath Tagore\",\r\n                    bookDelivered:\"8 April 2022\"\r\n                },\r\n                {   \r\n                    orderID:'46FA4F65A4F6A',\r\n                    bookName:\"A Thousand Splendid Suns\",\r\n                    bookPrice:\"1300\",\r\n                    bookImageURL:\"https://picsum.photos/200/300\",\r\n                    orderDate:\"2 April 2022\",\r\n                    shipTo: \"Ajay sharma\",\r\n                    bookYear: \"1910\",\r\n                    bookGenre: \"Poem\",\r\n                    bookAuthor:\"Rabindranath Tagore\",\r\n                    bookDelivered:\"8 April 2022\"\r\n                },\r\n            ],\r\n            id: this.$route.query.id,\r\n            orders: []\r\n        }\r\n    },\r\n    async created(){\r\n            this.orderedHistory = [];\r\n            var name;\r\n            await firebase.firestore().collection('Users').doc(this.id).get().then( snapshot => {\r\n                this.orders = snapshot.data().orders;\r\n                name = snapshot.data().name;    \r\n            });\r\n            console.log(this.orders);\r\n            \r\n            this.orders.forEach(async order => {\r\n                var orderID = order;\r\n                await firebase.firestore().collection('Orders').doc(order).get().then(r => {\r\n                    if(r.data().orderCompleted === true){\r\n                        var orderDate = this.calcTime(r.data().orderDate);\r\n                        \r\n                        var bookDelivered = this.calcTime(r.data().bookDelivered)\r\n                        r.data().books.forEach(async book => {\r\n                            var obj = new Object;\r\n                            await firebase.firestore().collection('books').doc(book).get().then(r => {\r\n                                console.log(r.data());\r\n                                obj.bookName = r.data().name;\r\n                                obj.bookID = book;\r\n                                obj.bookPrice = r.data().price;\r\n                                obj.bookYear = r.data().publicationYear;\r\n                                obj.bookGenre = r.data().genre;\r\n                                obj.bookAuthor = r.data().author;\r\n                                obj.bookImageURL = r.data().url;\r\n                            }).finally(() => {\r\n                                obj.shipTo = name;\r\n                                obj.orderID = orderID;\r\n                                obj.orderDate = orderDate;\r\n                                obj.bookDelivered = bookDelivered;\r\n                                this.orderedHistory.push(obj);\r\n                                console.log(this.orderedHistory);\r\n                                obj = new Object;\r\n                            })\r\n                        })\r\n                    }\r\n                })\r\n            })\r\n            \r\n\r\n            \r\n\r\n\r\n\r\n            // const ordersRef = collection(db, 'Orders');\r\n            // const q = query(ordersRef, where(\"orderCompleted\",\"==\", true))\r\n            \r\n            // const querySnapshot = await getDocs(q);\r\n            // querySnapshot.forEach(doc => {\r\n                // this.orders = doc.data();\r\n            // })\r\n            // console.log(this.orders)\r\n    },\r\n    methods: {\r\n        calcTime(timestamp){\r\n            timestamp = timestamp ?? 0;\r\n            var seconds = timestamp.seconds;\r\n            var time = new Date(seconds * 1000);\r\n            var date = time.getDate() < 10 ? \"0\" + time.getDate() : time.getDate();\r\n            var year = time.getFullYear();\r\n            var month = time.getMonth() < 10 ? \"0\" + time.getMonth() : time.getMonth();\r\n            return date + \"-\" + month + '-' + year;\r\n        }\r\n    },\r\n    components:{\r\n    Header,\r\n    Filter,\r\n    LatestBooks,\r\n    ResultBook,\r\n    BookCoverCat,\r\n    Sidebar, \r\n    OrderHistory\r\n    },\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div class=\"relative\" >\r\n        <!-- Header -->\r\n        <div class=\"\">\r\n            <Header :userID=\"id\" class=\"fixed z-10 w-full top-0\" />\r\n        </div>\r\n        \r\n        <!-- Filter -->\r\n        <div class=\"absoulute\">\r\n            <div class=\"\">              \r\n                <div class=\"fixed w-full\">\r\n                    <Sidebar />\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Order History -->\r\n        <div class=\"mt-20 absolute top-6 left-96\">\r\n            <div class=\"w-240\">\r\n                <div class=\"text-3xl font-bold text-gray-700\">ORDER HISTORY</div>\r\n                <div v-for=\"item in orderedHistory\" :key=\"item.id\">\r\n                        <OrderHistory :bookID=\"item.bookID\" :orderID=\"item.orderID\" :bookName=\"item.bookName\" :bookPrice=\"item.bookPrice\" :bookImageURL=\"item.bookImageURL\" :orderDate=\"item.orderDate\" :shipTo=\"item.shipTo\" :bookYear=\"item.bookYear\" :bookGenre=\"item.bookGenre\" :bookAuthor=\"item.bookAuthor\" :bookDelivered=\"item.bookDelivered\" />\r\n                    </div>\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n    \r\n        \r\n</template>\r\n\r\n<style>\r\n</style>\r\n\r\n                    <!-- <ResultBook :bookName=\"item.bookName\" :bookDate=\"item.bookDate\" :bookLanguage=\"item.bookLanguage\" :bookCover=\"item.bookCover\" :bookPrice=\"item.bookPrice\" :bookImageURL=\"item.bookImageURL\"/> -->"]},"metadata":{},"sourceType":"module"}