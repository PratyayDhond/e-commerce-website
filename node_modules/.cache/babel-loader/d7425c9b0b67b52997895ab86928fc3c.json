{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"relative\"\n};\nconst _hoisted_2 = {\n  class: \"\"\n};\nconst _hoisted_3 = {\n  class: \"absoulute\"\n};\nconst _hoisted_4 = {\n  class: \"\"\n};\nconst _hoisted_5 = {\n  class: \"fixed w-full\"\n};\nconst _hoisted_6 = {\n  class: \"mt-20 absolute top-6 left-96\"\n};\nconst _hoisted_7 = {\n  class: \"w-240\"\n};\n\nconst _hoisted_8 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"text-3xl font-bold text-gray-700\"\n}, \"ORDER HISTORY\", -1\n/* HOISTED */\n);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Header = _resolveComponent(\"Header\");\n\n  const _component_Sidebar = _resolveComponent(\"Sidebar\");\n\n  const _component_OrderHistory = _resolveComponent(\"OrderHistory\", true);\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" Header \"), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_Header, {\n    userID: $data.id,\n    class: \"fixed z-10 w-full top-0\"\n  }, null, 8\n  /* PROPS */\n  , [\"userID\"])]), _createCommentVNode(\" Filter \"), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_Sidebar)])])]), _createCommentVNode(\" Order History \"), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_hoisted_8, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.orderedHistory, item => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: item.id\n    }, [_createVNode(_component_OrderHistory, {\n      bookID: item.bookID,\n      orderID: item.orderID,\n      bookName: item.bookName,\n      bookPrice: item.bookPrice,\n      bookImageURL: item.bookImageURL,\n      orderDate: item.orderDate,\n      shipTo: item.shipTo,\n      bookYear: item.bookYear,\n      bookGenre: item.bookGenre,\n      bookAuthor: item.bookAuthor,\n      bookDelivered: item.bookDelivered\n    }, null, 8\n    /* PROPS */\n    , [\"bookID\", \"orderID\", \"bookName\", \"bookPrice\", \"bookImageURL\", \"orderDate\", \"shipTo\", \"bookYear\", \"bookGenre\", \"bookAuthor\", \"bookDelivered\"])]);\n  }), 128\n  /* KEYED_FRAGMENT */\n  ))])])]);\n}","map":{"version":3,"mappings":";;EA0HSA,KAAK,EAAC;;;EAEFA,KAAK,EAAC;;;EAKNA,KAAK,EAAC;;;EACFA,KAAK,EAAC;;;EACFA,KAAK,EAAC;;;EAOdA,KAAK,EAAC;;;EACFA,KAAK,EAAC;;;gCACPC,oBAAiE,KAAjE,EAAiE;EAA5DD,KAAK,EAAC;AAAsD,CAAjE,EAA8C,eAA9C,EAA2D;AAAA;AAA3D;;;;;;;;;uBAlBZE,oBA0BM,KA1BN,cA0BM,CAzBFC,+BAyBE,EAxBFF,oBAEM,KAFN,cAEM,CADFG,aAAuDC,iBAAvD,EAAuD;IAA9CC,MAAM,EAAEC,QAAsC;IAAlCP,KAAK,EAAC;EAA4B,CAAvD;;EAAA,aACE,CAFN,CAwBE,EApBFG,+BAoBE,EAnBFF,oBAMM,KANN,cAMM,CALFA,oBAIM,KAJN,cAIM,CAHFA,oBAEM,KAFN,cAEM,CADFG,aAAWI,kBAAX,CACE,CAFN,CAGE,CAJN,CAKE,CANN,CAmBE,EAXFL,sCAWE,EAVFF,oBAQM,KARN,cAQM,CAPFA,oBAKM,KALN,cAKM,CAJFQ,UAIE,qBAHFP,oBAEUQ,SAFV,EAEU,IAFV,EAEUC,YAFUJ,oBAEV,EAFEK,IAAsB,IAAlB;yBAAhBV,oBAEU,KAFV,EAEU;MAF2BW,GAAG,EAAED,IAAI,CAACE;IAErC,CAFV,GACQV,aAAgUW,uBAAhU,EAAgU;MAAjTC,MAAM,EAAEJ,IAAI,CAACI,MAAoS;MAA3RC,OAAO,EAAEL,IAAI,CAACK,OAA6Q;MAAnQC,QAAQ,EAAEN,IAAI,CAACM,QAAoP;MAAzOC,SAAS,EAAEP,IAAI,CAACO,SAAyN;MAA7MC,YAAY,EAAER,IAAI,CAACQ,YAA0L;MAA3KC,SAAS,EAAET,IAAI,CAACS,SAA2J;MAA/IC,MAAM,EAAEV,IAAI,CAACU,MAAkI;MAAzHC,QAAQ,EAAEX,IAAI,CAACW,QAA0G;MAA/FC,SAAS,EAAEZ,IAAI,CAACY,SAA+E;MAAnEC,UAAU,EAAEb,IAAI,CAACa,UAAkD;MAArCC,aAAa,EAAEd,IAAI,CAACc;IAAiB,CAAhU;;IAAA,iJADR;GAEU,CAFV;;EAAA,CAGE,EALN,CAOE,CARN,CAUE,CA1BN","names":["class","_createElementVNode","_createElementBlock","_createCommentVNode","_createVNode","_component_Header","userID","$data","_component_Sidebar","_hoisted_8","_Fragment","_renderList","item","key","id","_component_OrderHistory","bookID","orderID","bookName","bookPrice","bookImageURL","orderDate","shipTo","bookYear","bookGenre","bookAuthor","bookDelivered"],"sourceRoot":"","sources":["W:\\Coding\\finalProject\\e-commerce-website\\src\\views\\OrderHistory\\OrderHistory.vue"],"sourcesContent":["<script>\r\nimport Header from '../../components/Header/Header.vue';\r\nimport Filter from '../../components/Filter/Filter.vue';\r\nimport LatestBooks from '../../components/HomePage/LatestBooks.vue';\r\nimport ResultBook from '../../components/Search/ResultBook.vue';\r\nimport BookCoverCat from '../../components/HomePage/BookCoverCat.vue';\r\nimport Sidebar from '../../components/User/OrderHistoryView/Sidebar.vue';\r\nimport OrderHistory from '../../components/User/OrderHistoryView/OrderHistory.vue';\r\nimport firebase from 'firebase/compat/app';\r\n\r\nexport default{\r\n    data(){\r\n        return{\r\n            orderedHistory:[\r\n                {   \r\n                    orderID:'46FA4F65A4F6A',\r\n                    bookName:\"Gitanjali\",\r\n                    bookPrice:\"1300\",\r\n                    bookImageURL:\"https://picsum.photos/200/300\",\r\n                    orderDate:\"2 April 2022\",\r\n                    shipTo: \"Ajay sharma\",\r\n                    bookYear: \"1910\",\r\n                    bookGenre: \"Poem\",\r\n                    bookAuthor:\"Rabindranath Tagore\",\r\n                    bookDelivered:\"8 April 2022\"\r\n                },\r\n                {   \r\n                    orderID:'46FA4F65A4F6A',\r\n                    bookName:\"A Thousand Splendid Suns\",\r\n                    bookPrice:\"1300\",\r\n                    bookImageURL:\"https://picsum.photos/200/300\",\r\n                    orderDate:\"2 April 2022\",\r\n                    shipTo: \"Ajay sharma\",\r\n                    bookYear: \"1910\",\r\n                    bookGenre: \"Poem\",\r\n                    bookAuthor:\"Rabindranath Tagore\",\r\n                    bookDelivered:\"8 April 2022\"\r\n                },\r\n            ],\r\n            id: this.$route.query.id,\r\n            orders: []\r\n        }\r\n    },\r\n    async created(){\r\n            this.orderedHistory = [];\r\n            var name;\r\n            await firebase.firestore().collection('Users').doc(this.id).get().then( snapshot => {\r\n                this.orders = snapshot.data().orders;\r\n                name = snapshot.data().name;    \r\n            });\r\n            console.log(this.orders);\r\n            \r\n            this.orders.forEach(async order => {\r\n                var orderID = order;\r\n                await firebase.firestore().collection('Orders').doc(order).get().then(r => {\r\n                    if(r.data().orderCompleted === true){\r\n                        var orderDate = this.calcTime(r.data().orderDate);\r\n                        \r\n                        var bookDelivered = this.calcTime(r.data().bookDelivered)\r\n                        r.data().books.forEach(async book => {\r\n                            var obj = new Object;\r\n                            await firebase.firestore().collection('books').doc(book).get().then(r => {\r\n                                console.log(r.data());\r\n                                obj.bookName = r.data().name;\r\n                                obj.bookID = book;\r\n                                obj.bookPrice = r.data().price;\r\n                                obj.bookYear = r.data().publicationYear;\r\n                                obj.bookGenre = r.data().genre;\r\n                                obj.bookAuthor = r.data().author;\r\n                                obj.bookImageURL = r.data().url;\r\n                            }).finally(() => {\r\n                                obj.shipTo = name;\r\n                                obj.orderID = orderID;\r\n                                obj.orderDate = orderDate;\r\n                                obj.bookDelivered = bookDelivered;\r\n                                this.orderedHistory.push(obj);\r\n                                console.log(this.orderedHistory);\r\n                                obj = new Object;\r\n                            })\r\n                        })\r\n                    }\r\n                })\r\n            })\r\n            \r\n\r\n            \r\n\r\n\r\n\r\n            // const ordersRef = collection(db, 'Orders');\r\n            // const q = query(ordersRef, where(\"orderCompleted\",\"==\", true))\r\n            \r\n            // const querySnapshot = await getDocs(q);\r\n            // querySnapshot.forEach(doc => {\r\n                // this.orders = doc.data();\r\n            // })\r\n            // console.log(this.orders)\r\n    },\r\n    methods: {\r\n        calcTime(timestamp){\r\n            timestamp = timestamp ?? 0;\r\n            var seconds = timestamp.seconds;\r\n            var time = new Date(seconds * 1000);\r\n            var date = time.getDate() < 10 ? \"0\" + time.getDate() : time.getDate();\r\n            var year = time.getFullYear();\r\n            var month = time.getMonth() < 10 ? \"0\" + time.getMonth() : time.getMonth();\r\n            return date + \"-\" + month + '-' + year;\r\n        }\r\n    },\r\n    components:{\r\n    Header,\r\n    Filter,\r\n    LatestBooks,\r\n    ResultBook,\r\n    BookCoverCat,\r\n    Sidebar, \r\n    OrderHistory\r\n    },\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div class=\"relative\" >\r\n        <!-- Header -->\r\n        <div class=\"\">\r\n            <Header :userID=\"id\" class=\"fixed z-10 w-full top-0\" />\r\n        </div>\r\n        \r\n        <!-- Filter -->\r\n        <div class=\"absoulute\">\r\n            <div class=\"\">              \r\n                <div class=\"fixed w-full\">\r\n                    <Sidebar />\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Order History -->\r\n        <div class=\"mt-20 absolute top-6 left-96\">\r\n            <div class=\"w-240\">\r\n                <div class=\"text-3xl font-bold text-gray-700\">ORDER HISTORY</div>\r\n                <div v-for=\"item in orderedHistory\" :key=\"item.id\">\r\n                        <OrderHistory :bookID=\"item.bookID\" :orderID=\"item.orderID\" :bookName=\"item.bookName\" :bookPrice=\"item.bookPrice\" :bookImageURL=\"item.bookImageURL\" :orderDate=\"item.orderDate\" :shipTo=\"item.shipTo\" :bookYear=\"item.bookYear\" :bookGenre=\"item.bookGenre\" :bookAuthor=\"item.bookAuthor\" :bookDelivered=\"item.bookDelivered\" />\r\n                    </div>\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n    \r\n        \r\n</template>\r\n\r\n<style>\r\n</style>\r\n\r\n                    <!-- <ResultBook :bookName=\"item.bookName\" :bookDate=\"item.bookDate\" :bookLanguage=\"item.bookLanguage\" :bookCover=\"item.bookCover\" :bookPrice=\"item.bookPrice\" :bookImageURL=\"item.bookImageURL\"/> -->"]},"metadata":{},"sourceType":"module"}