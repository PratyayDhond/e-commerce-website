{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport Header from '../../components/Header/Header.vue';\nimport Filter from '../../components/Filter/Filter.vue';\nimport LatestBooks from '../../components/HomePage/LatestBooks.vue';\nimport ResultBook from '../../components/Search/ResultBook.vue';\nimport OrderSummary from '../../components/Search/OrderCart.vue';\nimport OrderCart from '../../components/Search/OrderCart.vue';\nimport OrderDetails from '../OrderDetails/OrderDetails.vue';\nimport firebase from 'firebase/compat/app';\nexport default {\n  // props: [\"userID\"],\n  data() {\n    return {\n      cost: 0,\n      items: 0,\n      prices: [],\n      orderPlaced: false,\n      dis: 0,\n      //BOOKMARK\n      //Change this value according to the need\n      deliv: 40,\n      userID: this.$route.query.id,\n      books: [],\n      checkoutBooksUnique: new Set(),\n      checkoutBooks: new Map(),\n      checkoutBooksPrice: new Map(),\n      isLoaded: false\n    };\n  },\n\n  async created() {\n    const db = firebase.firestore(); // console.log(this.searchedBooks)\n\n    console.log(\"Inside created() method\");\n\n    try {\n      db.collection('Users').doc(this.userID).get().then(r => {\n        console.log(r.data());\n        var arr = r.data().cart;\n        console.log(arr);\n\n        for (let i = 0; i < arr.length; i++) {\n          db.collection('books').doc(arr[i]).get().then(book => {\n            var temp = book.data();\n            temp.id = arr[i];\n            this.books.push(temp);\n          });\n        }\n\n        console.log('Searched Books array');\n        console.log(this.books);\n      }).finally(() => {\n        this.isLoaded = true;\n        console.log(this.isLoaded);\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  },\n\n  components: {\n    Header,\n    Filter,\n    LatestBooks,\n    ResultBook,\n    OrderSummary,\n    OrderCart\n  },\n  methods: {\n    async checkout() {\n      console.log(\"Inside Checkout function\");\n      var amount = 0;\n      var quantity = 0;\n      var quantityArr = [];\n      this.checkoutBooksUnique.forEach(bookID => {\n        console.log(bookID);\n        console.log(bookID + \" \" + this.checkoutBooksPrice.get(bookID) * this.checkoutBooks.get(bookID));\n        amount += this.checkoutBooksPrice.get(bookID) * this.checkoutBooks.get(bookID);\n        quantity += this.checkoutBooks.get(bookID);\n        quantityArr.push(this.checkoutBooks.get(bookID));\n      });\n      if (quantity === 0) return alert('You cannot checkout with an empty cart!');\n      if (this.orderPlaced) return alert('Please wait until the current order is being processed');\n      console.log(this.orderPlaced);\n      this.orderPlaced = true;\n      var books = [];\n      this.checkoutBooksUnique.forEach(item => {\n        books.push(item);\n      }); // BOOKMARK: PAYWALL GOES HERE\n\n      var total = amount + this.deliv * quantity;\n      let orderID = \"\";\n      await firebase.firestore().collection(\"Orders\").add({\n        books: books,\n        quantity: quantityArr,\n        amount: amount,\n        total: total,\n        shippingCharges: this.deliv,\n        orderDate: new Date(),\n        // BOOKMARK: expected delivery to 14 days from order time.\n        expectedDate: new Date(Date.now() + 12096e5),\n        packageNo: \"\",\n        discount: 0,\n        orderCompleted: false,\n        bookDelivered: 0\n      }).then(snapshot => {\n        orderID = snapshot.id;\n      });\n      console.log(orderID);\n      var userData;\n      console.log(this.userID);\n      await firebase.firestore().collection(\"Users\").doc(this.userID).get().then(snapshot => {\n        console.log(snapshot.data());\n        userData = snapshot.data();\n      });\n      console.log(userData);\n      var orders = userData.orders ?? [];\n      orders.push(orderID);\n      firebase.firestore().collection(\"Users\").doc(this.userID).set({\n        addrLine1: userData.addrLine1,\n        addrLine2: userData.addrLine2,\n        //BOOKMARK : EMPTYING CART AFTER ORDERING\n        cart: [],\n        city: userData.city,\n        landmark: userData.landmark,\n        mobile: userData.mobile,\n        name: userData.name,\n        orders: orders,\n        state: userData.state,\n        wishList: userData.wishList,\n        zipcode: userData.zipcode,\n        email: userData.email\n      }).finally(() => {\n        this.books = [];\n        this.items = 0;\n        this.cost = 0;\n        this.discount = 0;\n        this.orderPlaced = false;\n        this.checkoutBooksUnique = new Set();\n        this.checkoutBooks = new Map();\n        this.checkoutBooksPrice = new Map();\n        alert(\"Order Placed Successfully\");\n      }); // })\n    },\n\n    calculateTotal(quantity) {\n      this.items += quantity;\n      this.cost += this.prices[this.prices.length - 1];\n      console.log(\"current cost : \" + this.cost);\n    },\n\n    calculate(price, quantity, bookID) {\n      this.prices.push(price);\n      console.log(bookID);\n      this.calculateTotal(quantity);\n      this.checkoutBooksUnique.add(bookID);\n      var count = this.checkoutBooks.get(bookID) || 0; // Checking for if book's quantity is decremented or incremented.\n\n      if (quantity === 1) this.checkoutBooks.set(bookID, count + 1);else if (quantity === -1) {\n        if (count > 0) this.checkoutBooks.set(bookID, count - 1);\n      }\n      if (price > 0) this.checkoutBooksPrice.set(bookID, price);\n      console.log(this.checkoutBooks);\n      console.log(this.checkoutBooksUnique);\n      console.log(this.checkoutBooksPrice);\n    },\n\n    updateCart(updatedCart) {\n      console.log(\"agasfas\");\n      console.log(updatedCart);\n      console.log(this.books);\n      var tempBooks = [];\n      this.books.forEach(book => {\n        console.log(book.id);\n        if (updatedCart.includes(book.id)) tempBooks.push(book); // if(book.id === )\n      });\n      console.log(tempBooks);\n      this.books = tempBooks;\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["Header","Filter","LatestBooks","ResultBook","OrderSummary","OrderCart","OrderDetails","firebase","data","cost","items","prices","orderPlaced","dis","deliv","userID","$route","query","id","books","checkoutBooksUnique","Set","checkoutBooks","Map","checkoutBooksPrice","isLoaded","created","db","firestore","console","log","collection","doc","get","then","r","arr","cart","i","length","book","temp","push","finally","e","components","methods","checkout","amount","quantity","quantityArr","forEach","bookID","alert","item","total","orderID","add","shippingCharges","orderDate","Date","expectedDate","now","packageNo","discount","orderCompleted","bookDelivered","snapshot","userData","orders","set","addrLine1","addrLine2","city","landmark","mobile","name","state","wishList","zipcode","email","calculateTotal","calculate","price","count","updateCart","updatedCart","tempBooks","includes"],"sourceRoot":"","sources":["W:\\Coding\\finalProject\\e-commerce-website\\src\\views\\Cart\\cart.vue"],"sourcesContent":["<script>\r\nimport Header from '../../components/Header/Header.vue';\r\nimport Filter from '../../components/Filter/Filter.vue';\r\nimport LatestBooks from '../../components/HomePage/LatestBooks.vue';\r\nimport ResultBook from '../../components/Search/ResultBook.vue';\r\nimport OrderSummary from '../../components/Search/OrderCart.vue';\r\nimport OrderCart from '../../components/Search/OrderCart.vue';\r\nimport OrderDetails from '../OrderDetails/OrderDetails.vue';\r\nimport firebase from 'firebase/compat/app'; \r\n\r\nexport default{\r\n  // props: [\"userID\"],\r\n   data(){\r\n     return{\r\n       cost: 0,\r\n       items: 0,\r\n       prices: [],\r\n       orderPlaced: false,\r\n        dis: 0,\r\n        //BOOKMARK\r\n        //Change this value according to the need\r\n         deliv: 40, \r\n        userID: this.$route.query.id,\r\n        books: [],\r\n        checkoutBooksUnique: new Set(),\r\n        checkoutBooks: new Map(),        \r\n        checkoutBooksPrice: new Map(), \r\n        isLoaded: false, \r\n     }\r\n   },\r\n   async created() {\r\n        const db = firebase.firestore(); \r\n        // console.log(this.searchedBooks)\r\n        console.log(\"Inside created() method\")\r\n\r\n        try{\r\n\r\n          db.collection('Users').doc(this.userID).get().then((r) => {\r\n            console.log(r.data());\r\n            var arr = r.data().cart;\r\n            console.log(arr);\r\n\r\n            for(let i = 0; i < arr.length; i++){\r\n              db.collection('books').doc(arr[i]).get().then((book) => {\r\n                var temp = book.data()\r\n                temp.id = arr[i]\r\n                this.books.push(temp)\r\n              })\r\n            }\r\n            console.log('Searched Books array')\r\n              console.log(this.books);  \r\n\r\n          }).finally(() => {this.isLoaded = true; console.log(this.isLoaded)});\r\n        }\r\n\r\n        catch(e){\r\n            console.log(e)\r\n        }\r\n    },\r\n\r\n    components:{\r\n    Header,\r\n    Filter,\r\n    LatestBooks,\r\n    ResultBook,\r\n    OrderSummary,\r\n    OrderCart\r\n},\r\nmethods: {\r\n  async checkout() {\r\n    console.log(\"Inside Checkout function\");\r\n    var amount = 0;\r\n    var quantity= 0;\r\n    var quantityArr = [];\r\n    this.checkoutBooksUnique.forEach((bookID) => {\r\n      console.log(bookID);\r\n      console.log(bookID + \" \" + this.checkoutBooksPrice.get(bookID) * this.checkoutBooks.get(bookID));\r\n      amount += this.checkoutBooksPrice.get(bookID) * this.checkoutBooks.get(bookID);\r\n      quantity += this.checkoutBooks.get(bookID);\r\n      quantityArr.push(this.checkoutBooks.get(bookID));\r\n    })\r\n    if(quantity === 0)\r\n      return alert('You cannot checkout with an empty cart!')\r\n    if(this.orderPlaced)\r\n      return alert('Please wait until the current order is being processed');\r\n      console.log(this.orderPlaced)\r\n    this.orderPlaced = true;\r\n      var books = [];\r\n      this.checkoutBooksUnique.forEach(item => {\r\n        books.push(item)\r\n      })\r\n    // BOOKMARK: PAYWALL GOES HERE\r\n    var total = amount + this.deliv * quantity;\r\n      let orderID = \"\";\r\n      await firebase.firestore().collection(\"Orders\").add({\r\n        books: books,\r\n        quantity: quantityArr,\r\n        amount: amount, \r\n        total:total,\r\n        shippingCharges: this.deliv,\r\n        orderDate: new Date(),\r\n        // BOOKMARK: expected delivery to 14 days from order time.\r\n        expectedDate: new Date(Date.now() + 12096e5),\r\n        packageNo: \"\",\r\n        discount: 0,\r\n        orderCompleted: false, \r\n        bookDelivered: 0,      \r\n      }).then(snapshot => {\r\n        orderID = snapshot.id;\r\n      })\r\n\r\n      console.log(orderID);\r\n      var userData;\r\n      console.log(this.userID)\r\n      await firebase.firestore().collection(\"Users\").doc(this.userID).get().then(snapshot => {\r\n        console.log(snapshot.data());\r\n        userData = snapshot.data();\r\n      })\r\n      console.log(userData);\r\n      var orders = userData.orders ?? [];\r\n      orders.push(orderID);\r\n\r\n      firebase.firestore().collection(\"Users\").doc(this.userID).set({\r\n        addrLine1: userData.addrLine1,  \r\n        addrLine2: userData.addrLine2,\r\n        //BOOKMARK : EMPTYING CART AFTER ORDERING\r\n        cart: [],\r\n        city: userData.city,\r\n        landmark:userData.landmark,\r\n        mobile: userData.mobile,\r\n        name: userData.name,\r\n        orders: orders,\r\n        state: userData.state,\r\n        wishList: userData.wishList,\r\n        zipcode: userData.zipcode,\r\n        email: userData.email,\r\n      }).finally( () => {\r\n        this.books = [];\r\n        this.items = 0;\r\n        this.cost = 0;\r\n        this.discount = 0;\r\n        this.orderPlaced = false;\r\n        this.checkoutBooksUnique = new Set();\r\n        this.checkoutBooks = new Map();\r\n        this.checkoutBooksPrice = new Map();\r\n        alert(\"Order Placed Successfully\");\r\n\r\n      })\r\n\r\n    // })\r\n  },\r\n  calculateTotal(quantity){\r\n    this.items += quantity \r\n       this.cost += this.prices[this.prices.length-1];\r\n       console.log(\"current cost : \" + this.cost) \r\n  },\r\n\r\n  calculate(price,quantity, bookID){\r\n    this.prices.push(price);\r\n    console.log(bookID);\r\n    this.calculateTotal(quantity);\r\n    this.checkoutBooksUnique.add(bookID);\r\n    var count = this.checkoutBooks.get(bookID) || 0;\r\n\r\n    // Checking for if book's quantity is decremented or incremented.\r\n    if(quantity === 1)\r\n    this.checkoutBooks.set(bookID,count+1);\r\n    else if(quantity === -1){\r\n      if(count > 0)\r\n        this.checkoutBooks.set(bookID,count-1);\r\n    }\r\n\r\n\r\n    if(price > 0)\r\n    this.checkoutBooksPrice.set(bookID,price);\r\n    console.log(this.checkoutBooks);\r\n    console.log(this.checkoutBooksUnique)\r\n    console.log(this.checkoutBooksPrice)\r\n  },\r\n  updateCart(updatedCart){\r\n    console.log(\"agasfas\")\r\n    console.log(updatedCart);\r\n    console.log(this.books);\r\n    var tempBooks = [];\r\n    this.books.forEach(book => {\r\n      console.log(book.id);\r\n      if(updatedCart.includes(book.id))\r\n        tempBooks.push(book);\r\n      // if(book.id === )\r\n    });\r\n    console.log(tempBooks);\r\n    this.books = tempBooks;\r\n  }\r\n}\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div class=\"relative \" >\r\n        <!-- Header -->\r\n        <div class=\"\">\r\n            <Header :userID=\"userID\" class=\"fixed z-10 w-full top-0\" />\r\n       \r\n        </div>\r\n     </div> \r\n\r\n        <div class=\"flex  mt-32 mx-28\">\r\n        <div class=\"w-4/6 \">\r\n          <div class=\"flex justify-between items-baseline   \">\r\n                <div class=\"  text-4xl font-bold font-calibri\" >Book Cart</div>\r\n                <div class=\"  text-2xl font font-calibri\">{{items}} items</div>\r\n          </div>\r\n                <div class=\"w-full bg-gray-300 h-px mt-5\"></div>\r\n<div>\r\n  <div v-if=\"this.isLoaded\">\r\n      <div v-if=\"this.books.length !== 0\">\r\n          <div class=\"flex\">\r\n          <div class=\"w-3/6\">\r\n                        <div class=\"flex justify-between\">\r\n            <p class=\"mt-6 pl-2  text-gray-400\">Product Details</p>\r\n            </div>\r\n          \r\n          </div>\r\n        <div class=\"w-1/6\">\r\n            <div class=\"flex justify-between\">\r\n            <p class=\"mt-6 ml-6 text-gray-400\">Quantity</p>\r\n            </div>\r\n          </div>\r\n        \r\n         <div class=\"w-1/6\">\r\n            <div class=\"flex justify-between\">\r\n            <p class=\"mt-6 pl-10  text-gray-400\">Price</p>\r\n            </div>\r\n          </div>\r\n         <div class=\"w-1/6\">\r\n            <div class=\"flex justify-between\">\r\n            <p class=\"mt-6 pl-12  text-gray-400\">Total</p>\r\n          </div>\r\n        </div>\r\n       </div>\r\n    </div>\r\n  </div>\r\n\r\n<div class=\"w-6/6 pt-4\">\r\n  <div v-if=\"this.isLoaded\">\r\n    <div v-if=\"this.books.length === 0\">\r\n        <div style=\"text-align: center;\">\r\n          <img src=\"../../assets/empty-box.png\" alt=\"\" style=\"height: 400px; margin: auto;\" >\r\n          <div style=\"position: relative; bottom: 10vh; font-size: 32px; color:#476582;\">Your Cart is empty :(</div>\r\n          <div style=\"position: relative; bottom: 10vh; font-size: 20px; color:#476582a4;\">Looks like you have not added anything to your Cart.</div>\r\n        </div>\r\n    </div>\r\n    <div v-else>\r\n        <div v-for=\"item in books\" :key=\"item.id\">\r\n        <!-- // Here what can be done is pass the value of data of book as parameter to the /book in order to show the details of the book cliked -->\r\n          <!-- <router-link to=\"/book\">   -->\r\n          <OrderCart @updateCart=\"updateCart\" @calculate=\"calculate\" :bookName=\"item.name\" :bookAuthor=\"item.author\" bookSubject=\"English\" bookGenre=\"-\" :bookDate=\"item.publicationYear\" :bookImageURL=\"item.url\" bookQuantity=\"0\" :bookPrice=\"item.price\" :id=\"this.userID\" :bookID=\"item.id\"/>\r\n        <!-- </router-link> -->\r\n        </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n</div>\r\n   \r\n</div>\r\n<div class= \" h-96 w-px bg-gray-300 ml-4 mr-4\"></div>\r\n  <div class=\"w-2/6\">\r\n    <div class=\"  text-4xl font-bold font-calibri\" >Order Summary</div>\r\n      <div class=\"w-full bg-gray-300 h-px mt-5\"></div>\r\n        <div class =\"flex justify-between\">\r\n          <p class=\"pt-8\">ITEMS {{items}}</p>\r\n          <p class= \"pt-8\">{{cost}}</p>\r\n        </div>\r\n        <div class =\"flex justify-between\">\r\n          <p class=\"pt-8\">DISCOUNT </p>\r\n          <p class= \"pt-8 \">{{dis}}</p>\r\n        </div>\r\n        \r\n        <div class =\"flex justify-between\">\r\n          <p class=\"pt-8\">DELIVERY CHARGES</p>\r\n          <p class= \"pt-8\"> {{deliv * this.items}}</p>\r\n        </div>\r\n        <div class =\"flex justify-between\">\r\n          <p class=\"pt-40 text-xl font-bold\">TOTAL COST</p>\r\n          <p class= \"pt-40 text-xl font-bold\">{{cost + deliv * this.items }}</p> \r\n        </div>\r\n        <div class=\"flex justify-center pt-6\">\r\n          <!-- <router-link to=\"404\"> -->\r\n            <!-- BOOKMARK -> Paywall will go here -->\r\n          <button class=\"bg-secondary-1 hover:bg-primary-1 hover:text-black text-white font-semibold text-xl h-10 pl-40 pr-40 tracking-widest \" @click=\"checkout\">CHECKOUT</button>\r\n          <!-- </router-link> -->\r\n        </div>    \r\n        <router-link to=\"/home\">\r\n        <div class=\"ml-18 mt-8 flex \" @click=\"true\">\r\n          <div class=\"flex py-2 items-center  text-sm text-black rounded-md text-center cursor-pointer fill-current hover:text-secondary-1 font-sm\">\r\n            <svg class=\"w-6 \" version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 400.004 400.004\" style=\"enable-background:new 0 0 400.004 400.004;\" xml:space=\"preserve\">\r\n              <g>\r\n                <path  d=\"M382.688,182.686H59.116l77.209-77.214c6.764-6.76,6.764-17.726,0-24.485c-6.764-6.764-17.73-6.764-24.484,0L5.073,187.757\r\n\t            \tc-6.764,6.76-6.764,17.727,0,24.485l106.768,106.775c3.381,3.383,7.812,5.072,12.242,5.072c4.43,0,8.861-1.689,12.242-5.072\r\n\t            \tc6.764-6.76,6.764-17.726,0-24.484l-77.209-77.218h323.572c9.562,0,17.316-7.753,17.316-17.315\r\n               \tC400.004,190.438,392.251,182.686,382.688,182.686z\"/>\r\n              </g>\r\n            </svg>      \r\n            \r\n            <div class = \"pl-2 text-xl\"  @click=\"true\">Continue Shopping</div>\r\n          </div>\r\n        </div> \r\n        </router-link>\r\n      </div>\r\n   </div>\r\n</template>\r\n\r\n<style>\r\n</style>"]},"metadata":{},"sourceType":"module"}